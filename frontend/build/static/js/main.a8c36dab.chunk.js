(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{133:function(e,t){},136:function(e,t,a){"use strict";a.r(t),window._=a(16),window.$=window.jQuery=a(4),a(4);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var s=a(4),n=a.n(s),r=(a(77),a(78),a(79),a(80),a(0)),o=a.n(r),i=a(26),c=a.n(i),l=a(72),u=a(27),m=a(14),d=(a(89),a(6)),p=a(5),h=a(8),g=a(7),f=(a(90),a(74)),E=a(3);a(14);function b(e){var t=e.component,a=Object(f.a)(e,["component"]);return o.a.createElement(E.a,Object.assign({},a,{render:function(e){return o.a.createElement(t,e)}}))}var v=a(1),y=a(73),_=a(16),S=a.n(_),k={WIKIQUOTE_MESSAGE:"wikiquote",OPEN_SITE_MESSAGE:"open_site",CAROUSEL_MESSAGE:"cardsCarousel",WEATHER_MESSAGE:"weather",IMAGE_MESSAGE:"image",TEXT_MESSAGE:"text",GENERIC_MESSAGE:"generalSearch",FIND_MESSAGE:"findSearch",BUTTON_TEXT_MESSAGE:"button_text",SMART_REPLY_MESSAGE:"smart_reply",LOADING_MESSAGE:"loading",BUTTON_LINK:"link",BUTTON_PARAM:"param"},w={TEXT_MESSAGE:"text",PARAMETER_MESSAGE:"parameter"},N={START:"start",HELP:"help",CHECK_SERVICE:"check_service"},O=a(13),T=a(23),x=a(14),C=function(e){Object(h.a)(a,e);var t=Object(g.a)(a);function a(e){var s;return Object(d.a)(this,a),(s=t.call(this,e)).chartReference=o.a.createRef(),s.state={m_index:null,right_card_open:!1,drop_mode:"",learn_more_folder_css:"learn-more-button",learn_more_chart_css:"learn-more-button",chart_data:{labels:["Red","Blue","Yellow"],datasets:[{data:[300,50,100],backgroundColor:["#FF6384","#36A2EB","#FFCE56"],hoverBackgroundColor:["#FF6384","#36A2EB","#FFCE56"]}]},options:{scales:{yAxes:[{ticks:{beginAtZero:!0}}]}}},s.onParamButtonClick=s.onParamButtonClick.bind(Object(v.a)(s)),s.onOpenSearX=s.onOpenSearX.bind(Object(v.a)(s)),s.onViewIFrame=s.onViewIFrame.bind(Object(v.a)(s)),s.onFolderButtonClick=s.onFolderButtonClick.bind(Object(v.a)(s)),s}return Object(p.a)(a,[{key:"componentDidUpdate",value:function(e,t,a){}},{key:"componentDidMount",value:function(){if(this.props.message.messageType===k.WEATHER_MESSAGE){var e=this.props.myWidgetParam;S.a.filter(e,{containerid:"openweathermap-widget-"+this.props.m_index}).length<1&&e.push({id:15,cityid:this.props.message.messageData[0].weather_city_id,appid:"3b1c3da41643a03de9516d4deb798f7b",units:this.props.weather_unit,containerid:"openweathermap-widget-"+this.props.m_index}),x.default.dispatch({type:"UPDATE_MESSAGES",myWidgetParam:e})}}},{key:"onCloseRightCard",value:function(){var e=this.props.user.messages;e[this.props.m_index].message.right_mode="",x.default.dispatch({type:"UPDATE_MESSAGES",messages:e})}},{key:"set_more",value:function(){var e=this.props.user.messages;e[this.props.m_index].message.right_mode="more",x.default.dispatch({type:"UPDATE_MESSAGES",messages:e})}},{key:"onViewIFrame",value:function(e,t,a){var s=e.url;"wikipedia"===e.title.toLocaleLowerCase()&&(s="https://wikipedia.outstep.com/search?content=wikipedia_en_all_maxi&pattern="+encodeURIComponent(t));var n=this.props.user.messages;"iframe"===n[this.props.m_index].message.right_mode?n[this.props.m_index].message.right_mode="":n[this.props.m_index].message.right_mode="iframe",n[this.props.m_index].message.i_url=s,x.default.dispatch({type:"UPDATE_MESSAGES",messages:n})}},{key:"onOpenSearX",value:function(e){var t=this.props.user.messages;t[this.props.m_index].message.right_mode="iframe",t[this.props.m_index].message.i_url="https://metasearch.outstep.com/?categories=general&language=en-US&q="+encodeURI(e),x.default.dispatch({type:"UPDATE_MESSAGES",messages:t})}},{key:"onFolderButtonClick",value:function(e,t){var a=this.props.user.messages;"suggestion"===a[this.props.m_index].message.drop_mode?a[this.props.m_index].message.drop_mode="":a[this.props.m_index].message.drop_mode="suggestion",x.default.dispatch({type:"UPDATE_MESSAGES",messages:a})}},{key:"onOpenNewWeb",value:function(e){window.open(e)}},{key:"onParamButtonClick",value:function(e,t,a){e.preventDefault(),this.props.isAdmin||this.props.onSend({messageType:w.PARAMETER_MESSAGE,messageData:[{payload:t,label:a}]})}},{key:"calculatePoint",value:function(e,t,a){var s=a.colorStart,n=a.colorEnd;return a.useEndAsStart?n-e*t:s+e*t}},{key:"interpolateColors",value:function(e,t,a){var s,n,r=a.colorStart,o=(a.colorEnd-r)/e,i=[];for(s=0;s<e;s++)n=this.calculatePoint(s,o,a),i.push(t(n));return i}},{key:"renderBotDiv",value:function(){if(this.props.message.messageType===k.WEATHER_MESSAGE){window.myWidgetParam=this.props.myWidgetParam;var e=document.getElementsByTagName("script")[0],t=document.createElement("script");t.async=!0,t.charset="utf-8",t.src="//openweathermap.org/themes/openweathermap/assets/vendor/owm/js/weather-widget-generator.js",e.parentNode.insertBefore(t,e)}var a=[k.WIKIQUOTE_MESSAGE,k.OPEN_SITE_MESSAGE,k.CAROUSEL_MESSAGE,k.GENERIC_MESSAGE,k.WEATHER_MESSAGE];return this.props.fromBot&&-1===a.indexOf(this.props.message.messageType)?o.a.createElement("div",{className:"btn btn-default btn-fab btn-fab-mini pull-left fadeIn bot-icon"},o.a.createElement("img",{src:"/images/favicon.png"})):this.props.fromBot&&this.props.message.messageType===k.WIKIQUOTE_MESSAGE?o.a.createElement("div",{className:"btn btn-default btn-fab btn-fab-mini pull-left fadeIn bot-icon"},o.a.createElement("img",{src:"/images/wikiquote-logo.png"})):void 0}},{key:"scrollToPrevPage",value:function(){document.querySelector("#paginated_cards_"+this.props.m_index).querySelector(".cards_scroller").scrollBy(-225,0)}},{key:"scrollToNextPage",value:function(){document.querySelector("#paginated_cards_"+this.props.m_index).querySelector(".cards_scroller").scrollBy(225,0)}},{key:"scrollToPrevMorePage",value:function(){document.querySelector("#paginated_cards_more_"+this.props.m_index).querySelector(".cards_scroller_more").scrollBy(-225,0)}},{key:"scrollToNextMorePage",value:function(){document.querySelector("#paginated_cards_more_"+this.props.m_index).querySelector(".cards_scroller_more").scrollBy(225,0)}},{key:"render",value:function(){var e=this,t=this.props.fromBot?"pull-left bubble-bot":"pull-right bubble-user",a=this.props.message.messageData,s="";switch(this.props.message.messageType){case k.FIND_MESSAGE:s=o.a.createElement("div",{className:"carousel-container "},a.info_boxes&&a.info_boxes[0].infobox&&o.a.createElement("div",{className:"carousel-item"},o.a.createElement("div",{className:"card",style:{display:"table",width:"40%"}},o.a.createElement("div",{className:"summary"},o.a.createElement("div",{className:"img-wrapper"},o.a.createElement("img",{style:{width:"100px"},src:a.info_boxes[0].img_src?a.info_boxes[0].img_src:"/images/logo-middle.png"})),o.a.createElement("div",{className:"content"},a.info_boxes[0].infobox&&o.a.createElement("div",{className:"title wrap-word"},a.info_boxes[0].infobox),a.info_boxes[0].content&&o.a.createElement("div",{className:"text wrap-word"},a.info_boxes[0].content.substr(0,200).split("\n").map((function(e,t){return o.a.createElement("div",{key:t},e)}))))),o.a.createElement("div",{className:"button-group"},a.suggestions&&o.a.createElement("a",{href:"#",className:"btn btn-block btn-primary",onClick:function(){return e.onFolderButtonClick(a.info_boxes[0].infobox,e.props.m_index)}},o.a.createElement("span",null,"LEARN MORE"),o.a.createElement("span",{className:this.state.learn_more_folder_css},"( Suggestions )"))),a.suggestions&&"suggestion"===this.props.message.drop_mode&&o.a.createElement("div",{className:"folder-summary"},o.a.createElement("div",{className:"carrot-folder-list"},a.suggestions.map((function(t,a){return o.a.createElement("div",{className:"valign-wrapper",style:{cursor:"pointer"},key:a,onClick:function(){return e.onOpenSearX(t)}},o.a.createElement("span",{style:{color:"#f9c44c",marginRight:"5px"},className:"glyphicon glyphicon-tree-deciduous","aria-hidden":"true"}," "),o.a.createElement("span",{className:"sentence-omit"},t))}))))),this.props.message.right_mode&&o.a.createElement("div",{className:"card",style:{width:"60%"}},o.a.createElement("div",{style:{display:"flow-root"}},o.a.createElement("i",{onClick:function(){return e.onCloseRightCard()},style:{color:"black"},className:"right material-icons"},"close")),"iframe"===this.props.message.right_mode&&o.a.createElement("div",{className:"iframe-content"},o.a.createElement(T.a,{src:this.props.message.i_url,className:"full-width-height"})))));break;case k.GENERIC_MESSAGE:s=o.a.createElement("div",{className:"carousel-container "},a.info_boxes&&a.info_boxes.length>0&&o.a.createElement("div",{className:"carousel-item"},o.a.createElement("div",{className:"card",style:{display:"table",width:"40%"}},o.a.createElement("div",{className:"summary"},o.a.createElement("div",{className:"img-wrapper"},o.a.createElement("img",{style:{width:"100px"},src:a.info_boxes[0].img_src?a.info_boxes[0].img_src:"/images/logo-middle.png"})),o.a.createElement("div",{className:"content"},a.info_boxes[0].infobox&&o.a.createElement("div",{className:"title wrap-word"},a.info_boxes[0].infobox),a.info_boxes[0].content&&o.a.createElement("div",{className:"text wrap-word"},a.info_boxes[0].content.substr(0,200).split("\n").map((function(e,t){return o.a.createElement("div",{key:t},e)}))))),o.a.createElement("div",{className:"button-group"},a.info_boxes[0].urls&&o.a.createElement("a",{className:"btn btn-block btn-primary"},o.a.createElement("div",{className:"row "},o.a.createElement("span",{className:"col s11",onClick:function(){return e.onViewIFrame(a.info_boxes[0].urls[0],a.info_boxes[0].infobox,e.props.m_index)}}," VIEW IN ",a.info_boxes[0].urls[0].title),o.a.createElement("i",{style:{position:"relative",top:"-5px"},className:"col s1 material-icons",onClick:function(){return e.onOpenNewWeb(a.info_boxes[0].urls[0].url)}},"launch"))),a.suggestions&&o.a.createElement("a",{href:"#",className:"btn btn-block btn-primary",onClick:function(){return e.onFolderButtonClick(a.info_boxes[0].infobox,e.props.m_index)}},o.a.createElement("span",null,"LEARN MORE"),o.a.createElement("span",{className:this.state.learn_more_folder_css},"( Suggestions )"))),a.suggestions&&"suggestion"===this.props.message.drop_mode&&o.a.createElement("div",{className:"folder-summary"},o.a.createElement("div",{className:"carrot-folder-list"},a.suggestions.map((function(t,a){return o.a.createElement("div",{className:"valign-wrapper",style:{cursor:"pointer"},key:a,onClick:function(){return e.onOpenSearX(t)}},o.a.createElement("span",{style:{color:"#f9c44c",marginRight:"5px"},className:"glyphicon glyphicon-tree-deciduous","aria-hidden":"true"}," "),o.a.createElement("span",{className:"sentence-omit"},t))}))))),this.props.message.right_mode&&o.a.createElement("div",{className:"card",style:{width:"60%"}},o.a.createElement("div",{style:{display:"flow-root"}},o.a.createElement("i",{onClick:function(){return e.onCloseRightCard()},style:{color:"black"},className:"right material-icons"},"close")),"iframe"===this.props.message.right_mode&&o.a.createElement("div",{className:"iframe-content"},o.a.createElement(T.a,{src:this.props.message.i_url,className:"full-width-height"})))));break;case k.WIKIQUOTE_MESSAGE:s=o.a.createElement("div",{className:"bubble card",style:{color:"black",border:"2px solid #ffe2e2",backgroundColor:"#fff5f5"}},o.a.createElement("div",{style:{background:"#ffe2e2",paddingTop:"0.1em",paddingBottom:"0.1em",textAlign:"center",fontSize:"larger",width:"100%"}},o.a.createElement("b",null,"Quote of the day")),o.a.createElement("div",null,a[0].text.split("~")[0]),o.a.createElement("div",{style:{fontStyle:"italic",textAlign:"right"}},"~",a[0].text.split("~")[1]));break;case k.OPEN_SITE_MESSAGE:s=o.a.createElement("div",{className:"open-site-container"},o.a.createElement("div",{className:"card",style:{display:"table",maxWidth:"300px",marginRight:"10px"}},o.a.createElement("div",{className:"site-title"},this.props.message.url),o.a.createElement("div",{className:"button-group"},o.a.createElement("a",{href:"#",className:"btn btn-block btn-primary"},o.a.createElement("span",{onClick:function(){return e.set_more(e.props.m_index)}},"View More"),o.a.createElement("i",{onClick:function(){return e.onOpenNewWeb("//"+e.props.message.url)},className:"material-icons"},"launch")))),"more"===this.props.message.right_mode&&o.a.createElement("div",{className:"card"},o.a.createElement("div",{style:{display:"block",textAlign:"center",height:"40px",padding:"10px"}},o.a.createElement("span",{style:{textAlign:"center",marginLeft:"11%"}},this.props.message.url),o.a.createElement("i",{onClick:function(){return e.onCloseRightCard()},style:{color:"black"},className:"right material-icons"},"close")),o.a.createElement("div",{className:"iframe-content"},o.a.createElement(T.a,{src:"//"+this.props.message.url,className:"full-width-height"}))));break;case k.CAROUSEL_MESSAGE:s=o.a.createElement("div",{style:{display:"flex"}},o.a.createElement("div",{id:"paginated_cards_"+this.props.m_index,className:"card cards",style:{display:"table",marginRight:"10px"}},o.a.createElement("div",{className:"cards_scroller"},a.map((function(t,a){return o.a.createElement("div",{key:a,className:"carousel_cards in-left"},o.a.createElement("img",{onClick:function(){return e.onOpenNewWeb(t.img_src)},className:"cardBackgroundImage",src:t.img_src}),o.a.createElement("div",{className:"cardFooter"},o.a.createElement("span",{className:"cardTitle",title:t.title},t.title),o.a.createElement("div",{className:"cardDescription"},o.a.createElement("div",{className:"stars-outer"},o.a.createElement("div",{className:"stars-inner",style:{width:Math.round(100*t.score)+"%"}})))))})),o.a.createElement("i",{onClick:function(){return e.scrollToPrevPage()},className:"arrow prev fa fa-chevron-circle-left "}," "),o.a.createElement("i",{onClick:function(){return e.scrollToNextPage()},className:"arrow next fa fa-chevron-circle-right"}," ")),o.a.createElement("div",{className:"button-group"},o.a.createElement("a",{href:"#",className:"btn btn-block btn-primary",onClick:function(){return e.set_more(e.props.m_index)}},o.a.createElement("span",null,"View More"),o.a.createElement("i",{className:"material-icons"},"launch")))),"more"===this.props.message.right_mode&&o.a.createElement("div",{id:"paginated_cards_more_"+this.props.m_index,className:"card cards_more"},o.a.createElement("div",{style:{display:"block",textAlign:"center",height:"40px",padding:"10px"}},o.a.createElement("span",{style:{textAlign:"center",marginLeft:"11%"}},this.props.message.keyword),o.a.createElement("i",{onClick:function(){return e.onCloseRightCard()},style:{color:"black"},className:"right material-icons"},"close")),o.a.createElement("div",{className:"cards_scroller_more"},o.a.createElement("i",{onClick:function(){return e.scrollToPrevMorePage()},className:"arrow prev fa fa-chevron-circle-left "}," "),o.a.createElement("i",{onClick:function(){return e.scrollToNextMorePage()},className:"arrow next fa fa-chevron-circle-right"}," "),this.props.arrays.map((function(t,a){return o.a.createElement("ul",{key:a,className:"carousel_cards in-left"},t.map((function(t,a){return o.a.createElement("li",{key:a},o.a.createElement("div",{className:"img-wrap"},o.a.createElement("img",{onClick:function(){return e.onOpenNewWeb(t.img_src)},className:"cardBackgroundImage_more",src:t.img_src})))})))})))));break;case k.WEATHER_MESSAGE:s=o.a.createElement("div",{className:"carousel-container"},o.a.createElement("div",{className:"carousel-item"},o.a.createElement("div",{className:"card",style:{width:"300px"}},this.props.message.main_weather&&o.a.createElement("div",{id:"openweathermap-widget-"+this.props.m_index}," "),o.a.createElement("div",{className:"button-group"},o.a.createElement("a",{href:"#",className:"btn btn-block btn-primary"},o.a.createElement("span",{onClick:function(){return e.props.onChangeTemperatureUnit(e.props.m_index)},className:"left"},"( F/C )"),o.a.createElement("span",{onClick:function(){return e.props.set_more_weather(e.props.m_index)}},"View More"),o.a.createElement("i",{onClick:function(){return e.onOpenNewWeb("//www.weather.com")},className:"material-icons"},"launch")))),this.props.message.more_weather&&o.a.createElement("div",{className:"card",style:{maxWidth:"680px",overflow:"hidden"}},o.a.createElement("div",{id:"openweathermap-widget-more-"+this.props.m_index}),o.a.createElement("div",{className:"button-group"},o.a.createElement("a",{href:"#",onClick:function(){return e.props.clear_more_weather(e.props.m_index)},className:"btn btn-block btn-primary"},o.a.createElement("i",{style:{color:"black"},className:"right material-icons"},"close"))))));break;case k.IMAGE_MESSAGE:s=o.a.createElement("div",{className:"carousel-container slideLeft"},a.map((function(e,t){return o.a.createElement("div",{key:t,className:"carousel-item"},o.a.createElement("div",{className:"card"},o.a.createElement("div",{className:"summary"},o.a.createElement("div",{className:"message-img-wrapper"},o.a.createElement("img",{style:{width:"300px"},src:e.image})))))})));break;case w.PARAMETER_MESSAGE:s=o.a.createElement("div",{className:"bubble card pullUp ".concat(t)},a[0].label||a[0].payload);break;case k.TEXT_MESSAGE:s=o.a.createElement("div",{className:"bubble card pullUp ".concat(t)},a[0].text.split("\n").map((function(e,t){return o.a.createElement("div",{key:t},e)})));break;case k.SMART_REPLY_MESSAGE:var n=a[0];s=o.a.createElement("div",null,o.a.createElement("div",{className:"bubble card pullUp ".concat(t)},n.text),n.smartReplies&&o.a.createElement("div",{className:"smart-reply-container slideUp"},n.smartReplies.map((function(t,a){return o.a.createElement("a",{key:a,href:"#",className:"smart-reply",onClick:function(a){return e.onParamButtonClick(a,t.uri,t.title)}},t.title)}))));break;case k.BUTTON_TEXT_MESSAGE:n=a[0];s=o.a.createElement("div",{className:"bubble card pullUp ".concat(t)},n.text.split("\n").map((function(e,t){return o.a.createElement("div",{key:t},e)})),n.buttons.length>0&&o.a.createElement("div",{className:"button-group"},n.buttons.map((function(t,a){switch(t.buttonType){case k.BUTTON_LINK:return o.a.createElement("a",{key:a,href:t.uri,target:"_blank",className:"btn btn-block btn-raised btn-info"},t.title,o.a.createElement("i",{className:"material-icons"},"launch"));case k.BUTTON_PARAM:return o.a.createElement("a",{key:a,href:"#","data-param":t.uri,onClick:function(a){return e.onParamButtonClick(a,t.uri,t.title)},className:"btn btn-block btn-raised btn-info"},t.title)}}))));break;case"carousel":case k.LOADING_MESSAGE:s=o.a.createElement("div",{className:"bubble card pullUp ".concat(t)},o.a.createElement("div",{className:"loading-dot dot-1"}),o.a.createElement("div",{className:"loading-dot dot-2"}),o.a.createElement("div",{className:"loading-dot dot-3"}))}return o.a.createElement("div",{className:"container-fluid"},this.renderBotDiv(),s)}}]),a}(o.a.Component);C.defaultProps={message:[],fromBot:!1,m_index:0};var A=Object(O.a)((function(e){return e}),(function(e,t){return{}}))(C),M=function(e){Object(h.a)(a,e);var t=Object(g.a)(a);function a(e){var s;return Object(d.a)(this,a),(s=t.call(this)).onChangeTemperatureUnit=function(e){var t=s.state.weather_unit;t="metric"===t?"imperial":"metric",s.setState({weather_unit:t}),s.clear_main_weather(e);var a=s.props.messages[e].message.more_weather;a&&s.clear_more_weather(e);var n=Object(v.a)(s);setTimeout((function(){n.set_main_weather(e),a&&n.set_more_weather(e)}),500)},s.clear_main_weather=function(e){var t=s.props.messages;t[e].message.main_weather=!1;var a=s.props.myWidgetParam;S.a.remove(a,{containerid:"openweathermap-widget-"+e}),s.props.ChangeStateFunc(a,t)},s.set_main_weather=function(e){var t=s.props.messages;t[e].message.main_weather=!0;var a=s.props.myWidgetParam;S.a.remove(a,{id:15,containerid:"openweathermap-widget-"+e}),S.a.filter(a,{containerid:"openweathermap-widget-"+e}).length<1&&a.push({id:15,cityid:t[e].message.messageData[0].weather_city_id,appid:s.props.weather_api_key,units:s.state.weather_unit,containerid:"openweathermap-widget-"+e}),s.props.ChangeStateFunc(a,t)},s.clear_more_weather=function(e){var t=s.props.messages;t[e].message.more_weather=!1;var a=s.props.myWidgetParam;S.a.remove(a,{containerid:"openweathermap-widget-more-"+e}),s.props.ChangeStateFunc(a,t)},s.set_more_weather=function(e){var t=s.props.messages;t[e].message.more_weather=!0;var a=s.props.myWidgetParam;S.a.remove(a,{id:11,containerid:"openweathermap-widget-more-"+e}),S.a.filter(a,{containerid:"openweathermap-widget-more-"+e}).length<1&&a.push({id:11,cityid:t[e].message.messageData[0].weather_city_id,appid:s.props.weather_api_key,units:s.state.weather_unit,containerid:"openweathermap-widget-more-"+e}),s.props.ChangeStateFunc(a,t)},s.state={weather_unit:"imperial"},s.messageLength=0,s}return Object(p.a)(a,[{key:"componentDidMount",value:function(){}},{key:"scrollToMessage",value:function(){var e=document.getElementById("messages-container");if(!this.props.isAdmin){var t=n()(".bubble-user").last().parent();t.length&&n()(e).animate({scrollTop:t.offset().top-n()(e).offset().top+n()(e).scrollTop()})}}},{key:"render",value:function(){var e=this,t=this.props.messages.map((function(t,a){var s=[];if(t.message.messageType===k.CAROUSEL_MESSAGE)for(var n=Object(y.a)(t.message.messageData);n.length>0;)s.push(n.splice(0,4));return o.a.createElement(A,{weather_api_key:e.props.weather_api_key,onChangeTemperatureUnit:e.onChangeTemperatureUnit,set_more_weather:e.set_more_weather,clear_more_weather:e.clear_more_weather,weather_unit:e.state.weather_unit,key:a,m_index:a,arrays:s,myWidgetParam:e.props.myWidgetParam,isAdmin:e.props.isAdmin,message:t.message,fromBot:t.fromBot,onSend:e.props.onSend})}));return this.messageLength<t.length&&(this.scrollToMessage(),this.messageLength=t.length),o.a.createElement("div",{id:"messages-container"},t,this.props.loading&&o.a.createElement(A,{message:{messageType:k.LOADING_MESSAGE},fromBot:!0}))}}]),a}(o.a.Component);M.defaultProps={messages:[],loading:!1};var P=Object(O.a)((function(e){return e}),(function(e,t){return{}}))(M),R=(a(92),a(17)),I=function(e){Object(h.a)(a,e);var t=Object(g.a)(a);function a(e){var s;return Object(d.a)(this,a),(s=t.call(this,e)).startRecord=function(){s.props.loading||(s.state.isRecording?s.stopRecording():(window.AudioContext=window.AudioContext||window.webkitAudioContext,s.audioContext=new AudioContext({sampleRate:16e3}),s.setState({isRecording:!0}),navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia,"undefined"===typeof navigator.mediaDevices.getUserMedia?navigator.getUserMedia({audio:!0},s.startUserMedia,(function(e){console.log("No live audio input in this browser: ".concat(e))})):navigator.mediaDevices.getUserMedia({audio:!0}).then(s.startUserMedia).catch((function(e){console.log("No live audio input in this browser: ".concat(e))}))))},s.stopRecording=function(){s.state.isRecording&&(s.mediaRecorder.stop(),s.set_stopRecording(),s.mediaRecorder.exportWAV(s.createFileLink),console.log("voice_stop"))},s.set_stopRecording=function(){s.audioContext.close().then((function(){console.log("streaming close")})),s.setState({isRecording:!1})},s.startUserMedia=function(e){var t=Object(v.a)(s);t.analyser=t.audioContext.createAnalyser();var a=t.audioContext.createMediaStreamSource(e).connect(t.analyser);console.log(t.analyser),t.mediaRecorder=new Recorder(a,{numChannels:1}),t.mediaRecorder.record(),window.setTimeout((function(){t.state.isRecording&&(t.mediaRecorder.stop(),t.set_stopRecording(),t.mediaRecorder.exportWAV(t.createFileLink),console.log("10 seconds, stop recording"))}),1e4);new VAD({source:a,voice_stop:function(){t.state.isRecording&&(t.mediaRecorder.stop(),t.set_stopRecording(),t.mediaRecorder.exportWAV(t.createFileLink),console.log("voice_stop"))},voice_start:function(){t.state.isRecording&&console.log("voice_start")}})},s.createFileLink=function(e){var t=Object(v.a)(s);console.log("recorder stopped"),s.waitForRespose=!0;var a=window.URL.createObjectURL(e),n=new XMLHttpRequest;n.open("GET",a,!0),n.responseType="blob",n.onload=function(){var e=new FileReader;e.readAsDataURL(n.response),e.onload=function(e){console.log("SEND RESULT TO THE BOT"),t.sendMessageToBot(e.target.result)}},n.send()},s.playMedia=function(e){var t=document.querySelector(".sound-clips");t.setAttribute("controls",""),t.setAttribute("autoplay",""),t.src=e},s.sendMessageToBot=function(e){m.default.dispatch({type:R.EMPTY_TYPE,loading:!0}),e&&e.length>=1&&-1!==e.indexOf("data:audio/wav")?(console.log("type: voice"),s.props.socket.emit("user_uttered",{type:"voice",message:e,room:s.props.userId})):(console.log("type: chat"),s.socket.emit("user_uttered",{type:"chat",message:e,room:s.props.userId}))},s.onControlMic=function(){s.props.createSocket(),s.setState({isFlyoutOpen:!1}),s.toggleOverlay(!1)},s.onSetSound=function(){s.props.isSound?m.default.dispatch({type:R.EMPTY_TYPE,isSound:!1}):m.default.dispatch({type:R.EMPTY_TYPE,isSound:!0})},s.inputMargin=60,s.audioContext=void 0,s.mediaRecorder={},s.analyser=void 0,s.canvas=void 0,s.ctx=void 0,s.canvasHeight=void 0,s.canvasWidth=void 0,s.countFrame=0,s.recordTime=void 0,s.state={chatInput:"",showSendButton:!1,sendDisabled:!0,inputMargin:s.inputMargin,isFlyoutOpen:!1,isRecording:!1},s.submitHandler=s.submitHandler.bind(Object(v.a)(s)),s.textChangeHandler=s.textChangeHandler.bind(Object(v.a)(s)),s.inputFocus=s.inputFocus.bind(Object(v.a)(s)),s.inputBlur=s.inputBlur.bind(Object(v.a)(s)),s.toggleFlyout=s.toggleFlyout.bind(Object(v.a)(s)),s.onFlyoutOptionClick=s.onFlyoutOptionClick.bind(Object(v.a)(s)),s}return Object(p.a)(a,[{key:"componentDidMount",value:function(){}},{key:"submitHandler",value:function(e){e.preventDefault(),""!==this.state.chatInput&&(this.setState({chatInput:"",sendDisabled:!0}),this.props.coordinate_lat&&this.props.coordinate_long?this.props.onSend({messageType:w.TEXT_MESSAGE,messageData:[{text:this.state.chatInput}],message:this.state.chatInput,location:{lat:this.props.coordinate_lat,long:this.props.coordinate_long}},this.state.chatInput):this.props.onSend({messageType:w.TEXT_MESSAGE,messageData:[{text:this.state.chatInput}],message:this.state.chatInput},this.state.chatInput))}},{key:"toggleOverlay",value:function(e){e?this.props.showOverlay():this.props.hideOverlay()}},{key:"toggleFlyout",value:function(){var e=!this.state.isFlyoutOpen;this.setState({isFlyoutOpen:e}),this.toggleOverlay(e)}},{key:"inputFocus",value:function(){this.setState({inputMargin:0,isFlyoutOpen:!1,showSendButton:!0})}},{key:"inputBlur",value:function(){var e=this.state.chatInput.length>0,t=e?0:this.inputMargin;this.setState({inputMargin:t,showSendButton:e})}},{key:"textChangeHandler",value:function(e){var t=e.target.value;this.setState({chatInput:t,sendDisabled:""===t})}},{key:"onFlyoutOptionClick",value:function(e,t){switch(this.setState({isFlyoutOpen:!1}),t){case"feedback":this.props.showFeedback();break;case"about":this.props.showAbout();break;case"start":default:this.props.showStart(!0)}this.toggleOverlay(!1)}},{key:"render",value:function(){var e=this,t="btn btn-fab btn-raised send-button"+(this.state.sendDisabled?" disabled":""),a="more-button-container"+(this.state.isFlyoutOpen?" active":"");return this.props.isAdmin?o.a.createElement("div",null):o.a.createElement("form",{onSubmit:this.submitHandler,id:"chat-input-container"},o.a.createElement("fieldset",null,o.a.createElement("div",{className:"form-group"},this.state.inputMargin>0&&o.a.createElement("div",{className:a},o.a.createElement("a",{onClick:function(t){return e.onFlyoutOptionClick(t,"start")},className:"button"},o.a.createElement("div",{className:"".concat("btn btn-raised btn-fab btn-fab-mini"," btn-info")},o.a.createElement("img",{src:"/images/icon-restart-32.png"})),o.a.createElement("span",null,"Start Over")),o.a.createElement("a",{onClick:function(t){return e.onFlyoutOptionClick(t,"feedback")},className:"button"},o.a.createElement("div",{className:"".concat("btn btn-raised btn-fab btn-fab-mini"," btn-danger")},o.a.createElement("img",{src:"/images/icon-feedback-32.png"})),o.a.createElement("span",null,"Feedback")),o.a.createElement("a",{onClick:function(t){return e.onFlyoutOptionClick(t,"about")},className:"button"},o.a.createElement("div",{className:"".concat("btn btn-raised btn-fab btn-fab-mini"," btn-success")},o.a.createElement("img",{src:"/images/icon-about-32.png"})),o.a.createElement("span",null,"About")),o.a.createElement("a",{className:"btn btn-fab btn-raised more-button",onClick:this.toggleFlyout},!this.state.isFlyoutOpen&&o.a.createElement("span",{className:"glyphicon glyphicon-arrow-right",style:{color:"white",fontSize:"29px",top:"12px"},"aria-hidden":"true"}," "),this.state.isFlyoutOpen&&o.a.createElement("span",{className:"glyphicon glyphicon-arrow-up",style:{color:"white",fontSize:"29px",top:"12px"},"aria-hidden":"true"}," "))),o.a.createElement("input",{type:"text",className:"form-control",id:"chat-input",onChange:this.textChangeHandler,value:this.state.chatInput,placeholder:"Enter Query Here",autoComplete:"off",style:{marginLeft:this.state.inputMargin},onFocus:this.inputFocus,onBlur:this.inputBlur}),this.state.showSendButton&&o.a.createElement("a",{href:"#",onClick:this.submitHandler,className:t},o.a.createElement("img",{src:"/images/icon-send-32.png"})),o.a.createElement("div",{className:"btn btn-fab btn-raised more-button",onClick:function(){return e.onSetSound()}},this.props.isSound&&o.a.createElement("i",{className:" material-icons",style:{left:"25px",fontSize:"30px",color:"green"}},"volume_down"),!this.props.isSound&&o.a.createElement("i",{className:" material-icons",style:{left:"25px",fontSize:"30px",color:"black"}},"volume_off")),o.a.createElement("audio",{className:"sound-clips",style:{display:"none"}}," "))))}}]),a}(o.a.Component);I.defaultProps={};var F=I,j=a(30),D=a.n(j),U=function(e){Object(h.a)(a,e);var t=Object(g.a)(a);function a(e){var s;return Object(d.a)(this,a),(s=t.call(this,e)).state={submitDisabled:!0,title:"",description:""},null==s.props.userId?s.userId=s.getUrlParam("userId"):s.userId=s.props.userId,s.titleChangeHandler=s.titleChangeHandler.bind(Object(v.a)(s)),s.descriptionChangeHandler=s.descriptionChangeHandler.bind(Object(v.a)(s)),s.onCloseClick=s.onCloseClick.bind(Object(v.a)(s)),s.onSubmitClick=s.onSubmitClick.bind(Object(v.a)(s)),s}return Object(p.a)(a,[{key:"getUrlParam",value:function(e){return decodeURIComponent(window.location.search.replace(new RegExp("^(?:.*[&\\?]"+encodeURIComponent(e).replace(/[\.\+\*]/g,"\\$&")+"(?:\\=([^&]*))?)?.*$","i"),"$1"))}}]),Object(p.a)(a,[{key:"setSubmitState",value:function(){this.setState({submitDisabled:this.state.title.length<5||this.state.description.length<20})}},{key:"titleChangeHandler",value:function(e){this.setState({title:e.target.value}),this.setSubmitState()}},{key:"descriptionChangeHandler",value:function(e){this.setState({description:e.target.value}),this.setSubmitState()}},{key:"onCloseClick",value:function(e){e.preventDefault(),this.props.hide&&this.props.hide()}},{key:"onSubmitClick",value:function(e){var t=this;if(e.preventDefault(),this.state.submitDisabled)n.a.snackbar({content:"Please provide more information"});else{var a=n.a.snackbar({content:"Submitting...",timeout:2e3});n.a.ajax({type:"POST",url:"/feedback",headers:{Accept:"application/json; charset=utf-8","Content-Type":"application/json; charset=utf-8"},dataType:"text",data:JSON.stringify({title:this.state.title,description:this.state.description,userId:this.userId}),success:function(e){t.setState({title:"",description:""}),a.snackbar("hide"),n.a.snackbar({content:"Feedback Submitted Successfully",timeout:5e3})},error:function(){a.snackbar("hide"),n.a.snackbar({content:"Error! Feedback could not be submitted. Please try again.",timeout:5e3})}}),this.props.hide()}}},{key:"render",value:function(){var e="btn btn-raised btn-primary"+(this.state.submitDisabled?" disabled":"");return o.a.createElement("div",null,o.a.createElement(D.a,{isOpen:this.props.isOpen,contentLabel:"Feedback Modal",style:{content:{border:"none",background:"none",top:20,left:20,right:20,bottom:20}}},o.a.createElement("div",{className:"card feedback-container slideDown"},o.a.createElement("form",null,o.a.createElement("fieldset",null,o.a.createElement("legend",null,"Feedback"),o.a.createElement("div",{className:"form-group"},o.a.createElement("input",{type:"text",value:this.state.title,onChange:this.titleChangeHandler,className:"form-control",placeholder:"Provide a short title (min 5 chars)"})),o.a.createElement("div",{className:"form-group"},o.a.createElement("textarea",{value:this.state.description,className:"form-control",onChange:this.descriptionChangeHandler,placeholder:"Please describe the issue or help us by suggesting a feature (min 20 chars)",rows:"3"})),o.a.createElement("div",{className:"form-group"},o.a.createElement("button",{onClick:this.onSubmitClick,className:e},"Submit"),this.props.hide&&o.a.createElement("button",{onClick:this.onCloseClick,className:"btn btn-raised btn-danger"},"Cancel")))))))}}]),a}(o.a.Component);U.defaultProps={userId:null};var B=U,G=function(e){Object(h.a)(a,e);var t=Object(g.a)(a);function a(e){var s;return Object(d.a)(this,a),(s=t.call(this,e)).onCloseClick=s.onCloseClick.bind(Object(v.a)(s)),s}return Object(p.a)(a,[{key:"componentDidMount",value:function(){D.a.setAppElement(this.mm)}},{key:"getUrlParam",value:function(e){return decodeURIComponent(window.location.search.replace(new RegExp("^(?:.*[&\\?]"+encodeURIComponent(e).replace(/[\.\+\*]/g,"\\$&")+"(?:\\=([^&]*))?)?.*$","i"),"$1"))}}]),Object(p.a)(a,[{key:"onCloseClick",value:function(e){e.preventDefault(),this.props.hide&&this.props.hide()}},{key:"render",value:function(){var e=this;return o.a.createElement("div",{ref:function(t){return e.mm=t}},o.a.createElement(D.a,{isOpen:this.props.isOpen,contentLabel:"About Modal",style:{content:{border:"none",background:"none",top:20,left:20,right:20,bottom:20,zIndex:10}}},o.a.createElement("div",{className:"card feedback-container slideDown"},o.a.createElement("form",null,o.a.createElement("fieldset",null,o.a.createElement("legend",null,"Scarlet"),"The Next Generation (IPASE) Internet Personal Assistance Search Engine",o.a.createElement("h5",null,"Privacy Policy"),o.a.createElement("ul",null,o.a.createElement("li",null,"Leader : Lonnie Cumberland, PhD"),o.a.createElement("li",null,"Contact : Lonnie@outstep.com")),o.a.createElement("h5",null,"External APIs"),o.a.createElement("ol",null,o.a.createElement("li",null,"SearX API"),o.a.createElement("li",null,"Zomato API")),o.a.createElement("h5",null,"General Libraries"),o.a.createElement("ol",null,o.a.createElement("li",null,"Rasa"),o.a.createElement("li",null,"SocketIO"),o.a.createElement("li",null,"WebRTC")),o.a.createElement("h5",null,"Front Libraries/Frameworks"),o.a.createElement("ol",null,o.a.createElement("li",null,"React.js"),o.a.createElement("li",null,"Twitter Bootstrap"),o.a.createElement("li",null,"Bootstrap Material Design"),o.a.createElement("li",null,"LESS")),o.a.createElement("h5",null,"Backend Libraries/Frameworks"),o.a.createElement("ol",null,o.a.createElement("li",null,"SearX"),o.a.createElement("li",null,"Docker"),o.a.createElement("li",null,"NodeJS")),o.a.createElement("div",{className:"form-group"},o.a.createElement("button",{onClick:this.onCloseClick,className:"btn btn-raised btn-primary"},"Close")))))))}}]),a}(o.a.Component);G.defaultProps={};var L=G,H=(a(102),a(14)),W=function(e){Object(h.a)(a,e);var t=Object(g.a)(a);function a(e){var s;return Object(d.a)(this,a),(s=t.call(this)).getLocation=function(){navigator.geolocation?navigator.geolocation.getCurrentPosition(s.getUserPosition,s.handleLocationAccessError):console.log("Geolocation is not supported by this browser.")},s.getUserPosition=function(e){var t="Latitude: "+e.coords.latitude+" Longitude: "+e.coords.longitude;console.log("location: ",t),H.default.dispatch({type:R.EMPTY_TYPE,coordinate_lat:e.coords.latitude,coordinate_long:e.coords.longitude});var a={message:'/my_location{"latitude":'+e.coords.latitude+',"longitude":'+e.coords.longitude+"}"};s.makeRequest(a)},s.handleLocationAccessError=function(e){switch(e.code){case e.PERMISSION_DENIED:console.log("User denied the request for Geolocation.");break;case e.POSITION_UNAVAILABLE:console.log("Location information is unavailable.");break;case e.TIMEOUT:console.log("The request to get user location timed out.");break;case e.UNKNOWN_ERROR:console.log("An unknown error occurred.")}},s.ChangeStateFunc=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;s.setState({myWidgetParam:e}),t&&H.default.dispatch({type:R.EMPTY_TYPE,messages:t})},s.audio_play=function(e){return new Promise((function(t,a){var s=document.getElementById("response-voice");s.preload="auto",s.autoplay=!0,s.onerror=a,s.onended=t,s.src=e}))},s.getIncomingMessage=function(e){if(e.link){if(e.text){var t=[];t.push({text:e.text}),H.default.dispatch({bot_messages:t,type:"BOT_HOOK_SUCCESS",loading:!1})}var a=document.getElementById("response-voice");console.log(a),a.src=e.link;var s=a.play();null!==s&&s.catch((function(){a.play()}))}else{if(e.text){var n=[];n.push({text:e.text}),H.default.dispatch({bot_messages:n,type:"BOT_HOOK_SUCCESS",loading:!1})}if(e.object){var r=JSON.parse(e.object),o=[];if("generalSearch"===r.payload){var i=r.data;o.push({messageType:"generalSearch",messageData:i})}if("findSearch"===r.payload){var c=r.data;o.push({messageType:"findSearch",messageData:c,drop_mode:"suggestion",right_mode:"iframe",i_url:"https://metasearch.outstep.com/?categories=general&language=en-US&q="+encodeURI(c.suggestions[0])})}if("wikiquote"===r.payload){var l=[{text:r.text}];o.push({messageType:"wikiquote",messageData:l})}if("open_site"===r.payload){o.push({right_mode:"more",messageType:"open_site",messageData:[],url:r.url})}if("cardsCarousel"===r.payload){var u=r.data;o.push({messageType:"cardsCarousel",messageData:u,keyword:r.keyword})}if("weather"===r.payload){r.weather_city_name;var m=r.weather_city_id,d={};d.weather_city_id=m,o.push({main_weather:!0,more_weather:!1,messageType:"weather",messageData:[d]})}H.default.dispatch({bot_messages:o,type:"BOT_HOOK_SUCCESS",loading:!1})}}},s.state={myWidgetParam:[],loading:!1,showFeedback:!1,overlay:!1,showAbout:!1,i_url:null},s.uuid=s.getUuid(),s.sendHandler=s.sendHandler.bind(Object(v.a)(s)),s.showStart=s.showStart.bind(Object(v.a)(s)),s.showFeedbackModal=s.showFeedbackModal.bind(Object(v.a)(s)),s.hideFeedbackModal=s.hideFeedbackModal.bind(Object(v.a)(s)),s.showAboutModal=s.showAboutModal.bind(Object(v.a)(s)),s.hideAboutModal=s.hideAboutModal.bind(Object(v.a)(s)),s.showOverlay=s.showOverlay.bind(Object(v.a)(s)),s.hideOverlay=s.hideOverlay.bind(Object(v.a)(s)),s}return Object(p.a)(a,[{key:"componentDidMount",value:function(){var e=this;window.myWidgetParam||(window.myWidgetParam=[]);var t=document.getElementsByTagName("script")[0],a=document.createElement("script");a.src="//openweathermap.org/themes/openweathermap/assets/vendor/owm/js/d3.min.js",t.parentNode.insertBefore(a,t),this.props.isAdmin||setTimeout((function(){e.showStart()}),500)}},{key:"componentDidUpdate",value:function(e,t,a){if(this.props.user.bot_messages!==e.user.bot_messages&&!this.props.user.loading){if(this.props.user.sound_link){var s=document.getElementById("response-voice");console.log(s),this.audio_play(this.props.user.sound_link).then((function(){s.src=null}))}this.renderMessages(this.props.user.bot_messages)}this.props.user.messages!==e.user.messages&&this.setState({messages:this.props.user.messages}),this.props.user.myWidgetParam!==e.user.myWidgetParam&&this.setState({myWidgetParam:this.props.user.myWidgetParam})}},{key:"scrollToMessage",value:function(){var e=document.getElementById("messages-container");if(!this.props.isAdmin){var t=n()(".bubble-user").last().parent();t.length&&n()(e).animate({scrollTop:t.offset().top-n()(e).offset().top+n()(e).scrollTop()})}}},{key:"generateUuid",value:function(){var e=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var a=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?a:3&a||8).toString(16)}))}},{key:"getUuid",value:function(){if(localStorage){var e=localStorage.getItem("uuid");return e||(e=this.generateUuid(),localStorage.setItem("uuid",e),e)}return this.generateUuid()}},{key:"makeRequest",value:function(e){e.userId=this.uuid,e.isSound=this.props.user.isSound,console.log("makeRequest"),this.props.WebHookAction(e)}},{key:"renderMessages",value:function(e){var t=this,a=function(a){setTimeout((function(){var s={};e[a].messageType?s=e[a]:(s.messageData=[e[a]],e[a].hasOwnProperty("text")&&(s.messageType=s.messageType?s.messageType:"text"),e[a].hasOwnProperty("image")&&(s.messageType=s.messageType?s.messageType:"image")),t.addMessage({fromBot:!0,message:s})}),500*a)};for(var s in e)a(s)}},{key:"showStart",value:function(e){H.default.dispatch({type:"",messages:[]}),this.props.user.socket&&this.props.user.isSound?this.props.user.socket.emit("user_uttered",{type:"chat",message:"Today quote",room:this.props.user.userId}):this.makeRequest({message:"Today quote",messageType:w.PARAMETER_MESSAGE,messageData:[{payload:e?N.HELP:N.START}]})}},{key:"removeSmartReplies",value:function(){var e=this.props.user.messages;e.forEach((function(t,a){t.message.messageType===k.SMART_REPLY_MESSAGE&&delete e[a]})),H.default.dispatch({type:"",messages:e})}},{key:"sendHandler",value:function(e,t){var a={username:this.props.username,message:e,fromBot:!1};this.removeSmartReplies(),this.addMessage(a),this.props.user.socket&&this.props.user.isSound?(H.default.dispatch({type:R.EMPTY_TYPE,loading:!0}),this.props.user.socket.emit("user_uttered",{type:"chat",message:t,room:this.props.user.userId})):this.makeRequest(e)}},{key:"addMessage",value:function(e){var t=this.props.user.messages;t.push(e),H.default.dispatch({type:"UPDATE_MESSAGES",messages:t})}},{key:"showFeedbackModal",value:function(){this.setState({showFeedback:!0})}},{key:"hideFeedbackModal",value:function(){this.setState({showFeedback:!1})}},{key:"showAboutModal",value:function(){this.setState({showAbout:!0})}},{key:"hideAboutModal",value:function(){this.setState({showAbout:!1})}},{key:"showOverlay",value:function(){this.setState({overlay:!0})}},{key:"hideOverlay",value:function(){this.setState({overlay:!1})}},{key:"clearChatHistory",value:function(){this.setState({messages:[]})}},{key:"addChatHistory",value:function(e){var t=this.state.messages;for(var a in e)t.push(e[a]);this.setState({messages:t})}},{key:"render",value:function(){var e={};return this.props.height&&(e.height=this.props.height),o.a.createElement("div",{className:"card expandOpen",id:"chat-app-container",style:e},o.a.createElement(P,{weather_api_key:this.props.user.weather_api_key,ChangeStateFunc:this.ChangeStateFunc,messages:this.state.messages,myWidgetParam:this.state.myWidgetParam,onSend:this.sendHandler,isAdmin:this.props.isAdmin,loading:this.props.user.loading}),o.a.createElement(F,{coordinate_lat:this.props.user.coordinate_lat,coordinate_long:this.props.user.coordinate_long,isSound:this.props.user.isSound,loading:this.props.user.loading,socket:this.props.user.socket,userId:this.props.user.userId,isAdmin:this.props.isAdmin,onSend:this.sendHandler,showStart:this.showStart,showFeedback:this.showFeedbackModal,showAbout:this.showAboutModal,showOverlay:this.showOverlay,hideOverlay:this.hideOverlay}),o.a.createElement(B,{isOpen:this.state.showFeedback,hide:this.hideFeedbackModal,userId:this.getUuid()}),o.a.createElement(L,{isOpen:this.state.showAbout,hide:this.hideAboutModal}),this.state.overlay&&o.a.createElement("div",{className:"overlay"}," "),o.a.createElement("audio",{id:"response-voice",style:{display:"none"}}," "))}}]),a}(o.a.Component);W.defaultProps={isAdmin:!1};var q=Object(O.a)((function(e){return{user:e.user}}),(function(e,t){return{WebHookAction:function(t){return Object(R.WebHookAction)(e,t)}}}))(W),K=a(51),z=a.n(K),V=a(17).logout,Y=a(14),X=function(e){Object(h.a)(a,e);var t=Object(g.a)(a);function a(e){var s;return Object(d.a)(this,a),(s=t.call(this,e)).state={isSideNavOpen:!1,class_sideNavOpen:""},s.changeSideNav=s.changeSideNav.bind(Object(v.a)(s)),s.select_regulars_header=s.select_regulars_header.bind(Object(v.a)(s)),s}return Object(p.a)(a,[{key:"componentDidMount",value:function(){z.a.Sidenav.init(this.slide_out,{edge:"right"})}},{key:"select_regulars_header",value:function(){this.changeSideNav(),Y.default.dispatch({type:"",from:null})}},{key:"changeSideNav",value:function(){z.a.Sidenav.getInstance(this.slide_out).close()}},{key:"logout",value:function(){this.props.logout()}},{key:"componentDidUpdate",value:function(e,t,a){}},{key:"render",value:function(){var e=this;this.props.user.c_id;return o.a.createElement("nav",{className:"light-blue lighten-1",role:"navigation"},o.a.createElement("div",{className:"nav-wrapper container"},o.a.createElement("a",{id:"logo-container",href:"#",className:"left",style:{color:"rgb(240, 236, 211)",fontSize:20}},"Scarlet "),o.a.createElement("div",{className:"right title-desc"},o.a.createElement("span",null,"The Next Generation (IPASE) "),o.a.createElement("br",null),o.a.createElement("span",null,"Internet Personal Assistant Search Engine")),o.a.createElement("ul",{id:"nav-mobile",className:"sidenav",ref:function(t){return e.slide_out=t}},o.a.createElement("i",{onClick:function(){return e.changeSideNav()},style:{margin:"-14px 0",color:"black"},className:"right material-icons"},"close"),o.a.createElement("div",{className:"col full-height cluster-content"},"OPEN_IFRAME"===this.props.user.type&&o.a.createElement(T.a,{src:this.props.user.i_url,className:"col full-width-height"})),o.a.createElement("li",null)),o.a.createElement("a",{href:"#",style:{display:"none"},"data-target":"nav-mobile",className:"sidenav-trigger"},o.a.createElement("i",{className:"material-icons"},"menu"))))}}]),a}(r.Component),$=Object(O.a)((function(e){return e}),(function(e,t){return{logout:function(t){return V(e,t)}}}))(X),Q=function(e){Object(h.a)(a,e);var t=Object(g.a)(a);function a(e){var s;Object(d.a)(this,a),s=t.call(this,e);e.cookies;return s.state={},s}return Object(p.a)(a,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){return o.a.createElement(o.a.Fragment,null,o.a.createElement($,null),o.a.createElement("div",{className:"container full-height"},o.a.createElement(E.c,null,o.a.createElement(b,{path:"/",component:q}),o.a.createElement(E.a,{path:"*",exact:!0,component:q}))))}}]),a}(r.Component),J=Object(O.a)((function(e,t){return{user:e.user}}),(function(e){return{}}))(Q);c.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(l.a,{store:m.default},o.a.createElement(u.a,{basename:""},o.a.createElement(J,null)))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},14:function(e,t,a){"use strict";a.r(t);var s=a(19),n=a(24),r={userId:"",baseUrl:document.location.protocol+"//"+document.location.hostname+"/rasa",socket:null,loading:!1,error:null,messages:[],myWidgetParam:[],isSound:!1,coordinate_lat:null,coordinate_long:null,weather_api_key:"3b1c3da41643a03de9516d4deb798f7b"};var o=Object(s.c)({user:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"OPEN_IFRAME":case"OPEN_CLUSTER_FOLDER":case"OUT_STEP_HOOK_PENDING":case"OUT_STEP_HOOK_ERROR":case"OUT_STEP_HOOK_SUCCESS":case"BOT_HOOK_SUCCESS":case"BOT_HOOK_PENDING":case"BOT_HOOK_ERROR":case"UPDATE_MESSAGES":case"":case"CHANGE_VIEW_MODE":return Object(n.a)(Object(n.a)({},e),t);default:return e}}}),i=[a(71).a],c="undefined"!==typeof window&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||s.d,l=Object(s.e)(o,c(s.a.apply(void 0,i)));t.default=l},17:function(e,t,a){"use strict";a.r(t),a.d(t,"EMPTY_TYPE",(function(){return m})),a.d(t,"DATA_UPDATE_PENDING",(function(){return d})),a.d(t,"WebHookAction",(function(){return p}));var s=a(24),n=a(6),r=a(5),o=a(8),i=a(7),c=a(14),l=a(0),u=function(e){Object(o.a)(a,e);var t=Object(i.a)(a);function a(){return Object(n.a)(this,a),t.apply(this,arguments)}return Object(r.a)(a,null,[{key:"request",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"POST",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=c.default.getState();return e=r.user.baseUrl+e,"GET"===t&&((e=new URL(e)).search=new URLSearchParams(a)),fetch(e,{method:t,body:"POST"===t?JSON.stringify(a):null,headers:Object(s.a)(Object(s.a)({},n),{},{Accept:"application/json; charset=utf-8","Content-Type":"application/json; charset=utf-8"})}).then((function(e){return 401===e.status&&(window.location.href="/"),e.json()}))}},{key:"bindAuth",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.Authorization="Bearer "+e,t}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return a.request(e,"GET",t,s)}},{key:"post",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return a.request(e,"POST",t,s)}}]),a}(a.n(l).a.Component),m="",d="DATA_UPDATE_PENDING";function p(e,t){e({type:"BOT_HOOK_PENDING",loading:!0}),u.post("/webhooks/rest/webhook",t).then((function(t){if(t)if(t.exception||t.error||t.errors)e({type:"BOT_HOOK_ERROR",loading:!1,sound_link:null,error:t.errors?t.errors:t.message});else{var a=[],s=null;for(var n in t)if(t[n]&&t[n].custom){if("generalSearch"===t[n].custom.payload){var r=t[n].custom.data;a.push({messageType:"generalSearch",messageData:r})}if("findSearch"===t[n].custom.payload){var o=t[n].custom.data;a.push({messageType:"findSearch",messageData:o,drop_mode:"suggestion",right_mode:"iframe",i_url:"https://metasearch.outstep.com/?categories=general&language=en-US&q="+encodeURI(o.suggestions[0])})}if("wikiquote"===t[n].custom.payload){var i=[{text:t[n].custom.text}];a.push({messageType:"wikiquote",messageData:i})}if("open_site"===t[n].custom.payload){a.push({right_mode:"more",messageType:"open_site",messageData:[],url:t[n].custom.url})}if("cardsCarousel"===t[n].custom.payload){var c=t[n].custom.data;a.push({messageType:"cardsCarousel",messageData:c,keyword:t[n].custom.keyword})}if("weather"===t[n].custom.payload){var l=t[n].custom.weather_city_id,u={};u.weather_city_id=l,a.push({main_weather:!0,more_weather:!1,messageType:"weather",messageData:[u]})}}else t[n].hasOwnProperty("link")&&(s=t[n].link),a.push(t[n]);e({sound_link:s,bot_messages:a,type:"BOT_HOOK_SUCCESS",loading:!1})}else{e({bot_messages:[{text:"Maybe this is server error."}],type:"OUT_STEP_HOOK_SUCCESS",loading:!1,sound_link:null})}}))}},75:function(e,t,a){e.exports=a(136)},80:function(e,t,a){},89:function(e,t,a){},90:function(e,t,a){},92:function(e,t){!function(e){e.VAD=function(e){for(var t in this.options={fftSize:512,bufferLen:512,voice_stop:function(){},voice_start:function(){},smoothingTimeConstant:.99,energy_offset:1e-8,energy_threshold_ratio_pos:2,energy_threshold_ratio_neg:.5,energy_integration:1,filter:[{f:200,v:0},{f:2e3,v:1}],source:null,context:null},e)e.hasOwnProperty(t)&&(this.options[t]=e[t]);if(!this.options.source)throw new Error("The options must specify a MediaStreamAudioSourceNode.");this.options.context=this.options.source.context,this.hertzPerBin=this.options.context.sampleRate/this.options.fftSize,this.iterationFrequency=this.options.context.sampleRate/this.options.bufferLen,this.iterationPeriod=1/this.iterationFrequency;console.log("".concat("Vad | sampleRate: ").concat(this.options.context.sampleRate," | hertzPerBin: ").concat(this.hertzPerBin," | iterationFrequency: ").concat(this.iterationFrequency," | iterationPeriod: ").concat(this.iterationPeriod)),this.setFilter=function(e){this.filter=[];for(var t=0,a=this.options.fftSize/2;t<a;t+=1){this.filter[t]=0;for(var s=0,n=e.length;s<n;s+=1)if(t*this.hertzPerBin<e[s].f){this.filter[t]=e[s].v;break}}},this.setFilter(this.options.filter),this.ready={},this.vadState=!1,this.energy_offset=this.options.energy_offset,this.energy_threshold_pos=this.energy_offset*this.options.energy_threshold_ratio_pos,this.energy_threshold_neg=this.energy_offset*this.options.energy_threshold_ratio_neg,this.voiceTrend=0,this.voiceTrendMax=10,this.voiceTrendMin=-10,this.voiceTrendStart=5,this.voiceTrendEnd=-5,this.analyser=this.options.context.createAnalyser(),this.analyser.smoothingTimeConstant=this.options.smoothingTimeConstant,this.analyser.fftSize=this.options.fftSize,this.floatFrequencyData=new Float32Array(this.analyser.frequencyBinCount),this.floatFrequencyDataLinear=new Float32Array(this.floatFrequencyData.length),this.options.source.connect(this.analyser),this.scriptProcessorNode=this.options.context.createScriptProcessor(this.options.bufferLen,1,1),this.scriptProcessorNode.connect(this.options.context.destination);var a=this;this.scriptProcessorNode.onaudioprocess=function(e){a.analyser.getFloatFrequencyData(a.floatFrequencyData),a.update(),a.monitor()},this.options.source.connect(this.scriptProcessorNode),this.logging=!1,this.log_i=0,this.log_limit=100,this.triggerLog=function(e){this.logging=!0,this.log_i=0,this.log_limit="number"===typeof e?e:this.log_limit},this.log=function(e){this.logging&&this.log_i<this.log_limit?(this.log_i+=1,console.log(e)):this.logging=!1},this.update=function(){for(var e=this.floatFrequencyData,t=0,a=e.length;t<a;t+=1)this.floatFrequencyDataLinear[t]=Math.pow(10,e[t]/10);this.ready={}},this.getEnergy=function(){if(this.ready.energy)return this.energy;for(var e=0,t=this.floatFrequencyDataLinear,a=0,s=t.length;a<s;a+=1)e+=this.filter[a]*t[a]*t[a];return this.energy=e,this.ready.energy=!0,e},this.monitor=function(){var e=this.getEnergy(),t=e-this.energy_offset;t>this.energy_threshold_pos?this.voiceTrend=this.voiceTrend+1>this.voiceTrendMax?this.voiceTrendMax:this.voiceTrend+1:t<-this.energy_threshold_neg?this.voiceTrend=this.voiceTrend-1<this.voiceTrendMin?this.voiceTrendMin:this.voiceTrend-1:this.voiceTrend>0?this.voiceTrend-=1:this.voiceTrend<0&&(this.voiceTrend+=1);var a=!1,s=!1;this.voiceTrend>this.voiceTrendStart?a=!0:this.voiceTrend<this.voiceTrendEnd&&(s=!0);var n=t*this.iterationPeriod*this.options.energy_integration;return this.energy_offset+=n>0||!s?n:10*n,this.energy_offset=this.energy_offset<0?0:this.energy_offset,this.energy_threshold_pos=this.energy_offset*this.options.energy_threshold_ratio_pos,this.energy_threshold_neg=this.energy_offset*this.options.energy_threshold_ratio_neg,a&&!this.vadState&&(this.vadState=!0,this.options.voice_start()),s&&this.vadState&&(this.vadState=!1,this.options.voice_stop()),this.log("e: ".concat(e," | e_of: ").concat(this.energy_offset," | e+_th: ").concat(this.energy_threshold_pos," | e-_th: ").concat(this.energy_threshold_neg," | signal: ").concat(t," | int: ").concat(n," | voiceTrend: ").concat(this.voiceTrend," | start: ").concat(a," | end: ").concat(s)),t}}}(window)}},[[75,1,2]]]);
//# sourceMappingURL=main.a8c36dab.chunk.js.map